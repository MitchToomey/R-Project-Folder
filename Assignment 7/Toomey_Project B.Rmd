---
title: "Project B"
author: "Mitchell Toomey"
date: "February 26, 2021"
output: html_notebook
---

### 2

Write a function that has a single argument that is a data frame of raters (in columns) and their observation scores (in rows). The function should return a well-labeled data frame with all other raters (note that a single percent agreement is among two raters, so a separate percent agreement needs to be calculated for a rater with each other rater). These should be the mean of the percent agreement (PA) statistic, the SD of PA, and the minimum and maximum PA

```{r}

 rater_data <- function(data) 
   {
   N = nrow(data)
   R = ncol(data)
   
   counts <- NULL
   
   for(i in 1:(R-1)){
     for (j in (i+1):R){
           if (i != j) {  
             
             a <- data[, i]
             b <- data[, j]
             counts <- c(counts, sum(a == b))  
             percent <- (counts/length(a))*100  
                                               
      } else {NULL}
    }
  }
   
   PA <- matrix(percent, nrow= R, ncol= R)   
                                             
   Mean <- NULL
   SD <- NULL
   Min <- NULL
   Max <- NULL
   
   for (k in 1:ncol(PA)){                     
                                             
     Mean <- c(Mean, round(mean(PA[, k]), 2))
     SD <- c(SD, round(sd(PA[,k]),2))
     Min <- c(Min, round(min(PA[,k]),2))
     Max <- c(Max, round(max(PA[,k]),2))
  }
   df <- data.frame(rbind(Mean, SD, Min, Max)) 
   colnames(df) <- names(data)
   print(df)
 }
 
library(here)
raters <- read.csv(here("Data", "raters.csv"))
rater_data(raters[2:9])

```

### 3

Write a function that takes two arguments. The first is a data frame of raters (in columns) and their observation scores (in rows). The second is a matrix with two columns in which each row specifies the lowest and highest scores that should be collapsed to form a new category. The function should return a data frame of raters and their scores based on the newly formed categories

```{r}

# Write function with two arguments

  # argument 1: Create a data frame
    # raters in columns
    # observation scores  in rows
  
  # argument 2: Create a matrix with two columns
    # column 1: lowest scores collapsed into --> category 1
    # column 2: highest scores collapsed into --> category 2

# return a data frame
  # raters in columns
  # new observation scores recoded into 2 categories

num_raters <- ncol(my_dataframe)
num_observations <- nrow(my_dataframe)


collapse_matrix <- matrix(c(1, 2, 4, 4, 5, 6),  
                          ncol = 2,
                          byrow = TRUE)


```

